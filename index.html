<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fleet Operation Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e4e4e4;
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 2.5em;
            color: #00d4ff;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
            margin-bottom: 10px;
        }

        .header p {
            color: #b0b0b0;
            font-size: 1.1em;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .section {
            background: rgba(30, 30, 46, 0.8);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            font-size: 1.8em;
            color: #00d4ff;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
        }

        .vehicle-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .vehicle-card {
            background: linear-gradient(135deg, #2a2a40 0%, #1f1f2e 100%);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(0, 212, 255, 0.2);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .vehicle-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 24px rgba(0, 212, 255, 0.2);
        }

        .vehicle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .vehicle-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #00d4ff;
        }

        .vehicle-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .status-good {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
        }

        .status-warning {
            background: rgba(255, 193, 7, 0.2);
            color: #ffc107;
        }

        .status-alert {
            background: rgba(255, 82, 82, 0.2);
            color: #ff5252;
        }

        .vehicle-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 15px;
        }

        .info-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 8px;
            border-left: 3px solid #00d4ff;
        }

        .info-label {
            font-size: 0.85em;
            color: #b0b0b0;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #fff;
        }

        .chart-container {
            position: relative;
            height: 350px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .battery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .battery-card {
            background: linear-gradient(135deg, #2a2a40 0%, #1f1f2e 100%);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .battery-level {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }

        .battery-bar-container {
            flex: 1;
            height: 30px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            overflow: hidden;
            margin: 0 10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .battery-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00d4ff);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
        }

        .battery-bar.low {
            background: linear-gradient(90deg, #ff5252, #ff8a80);
        }

        .battery-bar.medium {
            background: linear-gradient(90deg, #ffc107, #ffeb3b);
        }

        .alert-box {
            background: rgba(255, 82, 82, 0.1);
            border-left: 4px solid #ff5252;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .alert-title {
            font-weight: bold;
            color: #ff5252;
            margin-bottom: 5px;
        }

        .data-source {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
        }

        .data-source input {
            width: 100%;
            max-width: 600px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(0, 212, 255, 0.5);
            border-radius: 5px;
            color: #fff;
            margin-top: 10px;
            font-size: 0.95em;
        }

        .data-source button {
            margin-top: 10px;
            padding: 10px 30px;
            background: linear-gradient(135deg, #00d4ff, #0099cc);
            border: none;
            border-radius: 5px;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .data-source button:hover {
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .vehicle-grid,
            .battery-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš› Fleet Operation Dashboard</h1>
        <p>ì¤‘ì†Œê·œëª¨ ë¬¼ë¥˜ ì—…ì²´ë¥¼ ìœ„í•œ í†µí•© ì°¨ëŸ‰ ë° ë°°í„°ë¦¬ ê´€ë¦¬ ì‹œìŠ¤í…œ</p>
    </div>

    <div class="dashboard-container">
        <!-- ì°¨ëŸ‰ í†µí•© ìƒíƒœ ì„¹ì…˜ -->
        <div class="section">
            <h2 class="section-title">ğŸ“Š ì°¨ëŸ‰ë³„ í†µí•© ìƒíƒœ</h2>
            <div class="vehicle-grid" id="vehicleGrid"></div>
        </div>

        <!-- ë°°í„°ë¦¬ ê´€ë¦¬ ì„¹ì…˜ -->
        <div class="section">
            <h2 class="section-title">ğŸ”‹ ë°°í„°ë¦¬ ê´€ë¦¬</h2>
            <div class="battery-grid" id="batteryGrid"></div>
            <div class="chart-container">
                <canvas id="batteryChart"></canvas>
            </div>
        </div>

        <!-- ë¹„ìš© ë¶„ì„ ì„¹ì…˜ -->
        <div class="section">
            <h2 class="section-title">ğŸ’° ì›”ë³„ ìš´ì˜ë¹„ ë¶„ì„</h2>
            <div class="chart-container">
                <canvas id="costChart"></canvas>
            </div>
        </div>

        <!-- ë°ì´í„° ì†ŒìŠ¤ ì„¤ì • -->
        <div class="section">
            <div class="data-source">
                <h3 style="color: #00d4ff; margin-bottom: 10px;">ğŸ“¡ Google Sheets ì—°ë™</h3>
                <p style="color: #b0b0b0; margin-bottom: 10px;">Google Sheetsë¥¼ CSVë¡œ ê³µê°œí•œ URLì„ ì…ë ¥í•˜ì„¸ìš”</p>
                <input type="text" id="sheetUrl" placeholder="ì˜ˆ: https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/export?format=csv">
                <button onclick="loadExternalData()">ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</button>
                <p style="color: #888; font-size: 0.9em; margin-top: 10px;">
                    * í˜„ì¬ëŠ” ìƒ˜í”Œ ë°ì´í„°ë¡œ êµ¬ë™ ì¤‘ì…ë‹ˆë‹¤
                </p>
            </div>
        </div>
    </div>

    <script>
        // ìƒ˜í”Œ ë°ì´í„° (ì‹¤ì œ ìš´ì˜ì‹œ Google Sheetsì—ì„œ ë¶ˆëŸ¬ì˜´)
        const sampleVehicles = [
            {
                id: 'V001',
                name: '1í†¤ íŠ¸ëŸ­ A',
                mileage: 45280,
                maintenanceDays: 15,
                fuelCost: 850000,
                status: 'good'
            },
            {
                id: 'V002',
                name: '2.5í†¤ íŠ¸ëŸ­ B',
                mileage: 67540,
                maintenanceDays: 3,
                fuelCost: 1250000,
                status: 'warning'
            },
            {
                id: 'V003',
                name: '5í†¤ íŠ¸ëŸ­ C',
                mileage: 89320,
                maintenanceDays: -2,
                fuelCost: 1780000,
                status: 'alert'
            },
            {
                id: 'V004',
                name: 'ë°´ D',
                mileage: 23450,
                maintenanceDays: 28,
                fuelCost: 620000,
                status: 'good'
            }
        ];

        const sampleBatteries = [
            { vehicle: '1í†¤ íŠ¸ëŸ­ A', level: 85, voltage: 12.6, current: 45, replaceDate: '2025-08-15' },
            { vehicle: '2.5í†¤ íŠ¸ëŸ­ B', level: 62, voltage: 12.2, current: 38, replaceDate: '2025-04-20' },
            { vehicle: '5í†¤ íŠ¸ëŸ­ C', level: 35, voltage: 11.8, current: 25, replaceDate: '2025-02-10' },
            { vehicle: 'ë°´ D', level: 92, voltage: 12.8, current: 52, replaceDate: '2025-10-05' }
        ];

        const monthlyCosts = {
            labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”'],
            repair: [850, 1200, 950, 1800, 1100, 1350],
            fuel: [3200, 3450, 3800, 3600, 3900, 4100]
        };

        // ì°¨ëŸ‰ ì¹´ë“œ ë Œë”ë§
        function renderVehicles() {
            const grid = document.getElementById('vehicleGrid');
            grid.innerHTML = '';

            sampleVehicles.forEach(vehicle => {
                const statusClass = `status-${vehicle.status}`;
                const statusText = vehicle.status === 'good' ? 'ì •ìƒ' : 
                                 vehicle.status === 'warning' ? 'ì£¼ì˜' : 'ê¸´ê¸‰';

                const card = document.createElement('div');
                card.className = 'vehicle-card';
                card.innerHTML = `
                    <div class="vehicle-header">
                        <div class="vehicle-name">${vehicle.name}</div>
                        <div class="vehicle-status ${statusClass}">${statusText}</div>
                    </div>
                    <div class="vehicle-info">
                        <div class="info-item">
                            <div class="info-label">ì£¼í–‰ê±°ë¦¬</div>
                            <div class="info-value">${vehicle.mileage.toLocaleString()} km</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ì •ë¹„ ì”ì—¬ì¼</div>
                            <div class="info-value">${vehicle.maintenanceDays > 0 ? vehicle.maintenanceDays : 0}ì¼</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ì´ë²ˆ ë‹¬ ìœ ë¥˜ë¹„</div>
                            <div class="info-value">${(vehicle.fuelCost / 10000).toFixed(0)}ë§Œì›</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ì°¨ëŸ‰ ID</div>
                            <div class="info-value">${vehicle.id}</div>
                        </div>
                    </div>
                    ${vehicle.maintenanceDays <= 0 ? `
                        <div class="alert-box">
                            <div class="alert-title">âš ï¸ ì •ë¹„ í•„ìš”</div>
                            <div>ì •ë¹„ ê¸°í•œì´ ${Math.abs(vehicle.maintenanceDays)}ì¼ ê²½ê³¼í–ˆìŠµë‹ˆë‹¤</div>
                        </div>
                    ` : ''}
                `;
                grid.appendChild(card);
            });
        }

        // ë°°í„°ë¦¬ ì¹´ë“œ ë Œë”ë§
        function renderBatteries() {
            const grid = document.getElementById('batteryGrid');
            grid.innerHTML = '';

            sampleBatteries.forEach(battery => {
                const levelClass = battery.level < 40 ? 'low' : battery.level < 70 ? 'medium' : '';
                const daysUntilReplace = Math.floor((new Date(battery.replaceDate) - new Date()) / (1000 * 60 * 60 * 24));

                const card = document.createElement('div');
                card.className = 'battery-card';
                card.innerHTML = `
                    <h3 style="color: #ffc107; margin-bottom: 15px;">${battery.vehicle}</h3>
                    <div class="battery-level">
                        <span style="font-weight: bold;">ì¶©ì „ë¥ :</span>
                        <div class="battery-bar-container">
                            <div class="battery-bar ${levelClass}" style="width: ${battery.level}%">
                                ${battery.level}%
                            </div>
                        </div>
                    </div>
                    <div class="vehicle-info">
                        <div class="info-item">
                            <div class="info-label">ì „ì••</div>
                            <div class="info-value">${battery.voltage}V</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ì „ë¥˜</div>
                            <div class="info-value">${battery.current}A</div>
                        </div>
                    </div>
                    ${daysUntilReplace < 30 ? `
                        <div class="alert-box">
                            <div class="alert-title">âš ï¸ êµì²´ ì˜ˆì •</div>
                            <div>${daysUntilReplace}ì¼ í›„ ë°°í„°ë¦¬ êµì²´ ì˜ˆì • (${battery.replaceDate})</div>
                        </div>
                    ` : `
                        <p style="color: #888; margin-top: 15px; text-align: center;">
                            ë‹¤ìŒ êµì²´ì¼: ${battery.replaceDate} (${daysUntilReplace}ì¼ í›„)
                        </p>
                    `}
                `;
                grid.appendChild(card);
            });
        }

        // ë°°í„°ë¦¬ ì¶”ì´ ì°¨íŠ¸
        function renderBatteryChart() {
            const ctx = document.getElementById('batteryChart').getContext('2d');
            
            // ì‹œë®¬ë ˆì´ì…˜ëœ ì‹œê³„ì—´ ë°ì´í„°
            const days = ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'];
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: days,
                    datasets: [
                        {
                            label: '1í†¤ íŠ¸ëŸ­ A ì „ì••(V)',
                            data: [12.8, 12.7, 12.6, 12.65, 12.6, 12.55, 12.6],
                            borderColor: '#00d4ff',
                            backgroundColor: 'rgba(0, 212, 255, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: '2.5í†¤ íŠ¸ëŸ­ B ì „ì••(V)',
                            data: [12.4, 12.3, 12.2, 12.25, 12.2, 12.15, 12.2],
                            borderColor: '#ffc107',
                            backgroundColor: 'rgba(255, 193, 7, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: '5í†¤ íŠ¸ëŸ­ C ì „ì••(V)',
                            data: [12.0, 11.9, 11.8, 11.85, 11.8, 11.75, 11.8],
                            borderColor: '#ff5252',
                            backgroundColor: 'rgba(255, 82, 82, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: '#e4e4e4' }
                        },
                        title: {
                            display: true,
                            text: 'ì¼ì£¼ì¼ê°„ ë°°í„°ë¦¬ ì „ì•• ì¶”ì´',
                            color: '#00d4ff',
                            font: { size: 16 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 11,
                            max: 13,
                            ticks: { color: '#b0b0b0' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#b0b0b0' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    }
                }
            });
        }

        // ë¹„ìš© ë¶„ì„ ì°¨íŠ¸
        function renderCostChart() {
            const ctx = document.getElementById('costChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: monthlyCosts.labels,
                    datasets: [
                        {
                            label: 'ìˆ˜ë¦¬ë¹„ (ë§Œì›)',
                            data: monthlyCosts.repair,
                            backgroundColor: 'rgba(255, 82, 82, 0.7)',
                            borderColor: '#ff5252',
                            borderWidth: 2
                        },
                        {
                            label: 'ì—°ë£Œë¹„ (ë§Œì›)',
                            data: monthlyCosts.fuel,
                            backgroundColor: 'rgba(0, 212, 255, 0.7)',
                            borderColor: '#00d4ff',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: '#e4e4e4' }
                        },
                        title: {
                            display: true,
                            text: 'ì›”ë³„ ìš´ì˜ë¹„ (ìˆ˜ë¦¬ë¹„ + ì—°ë£Œë¹„)',
                            color: '#00d4ff',
                            font: { size: 16 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { color: '#b0b0b0' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#b0b0b0' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    }
                }
            });
        }

        // ì™¸ë¶€ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜ (Google Sheets CSV)
        async function loadExternalData() {
            const url = document.getElementById('sheetUrl').value;
            if (!url) {
                alert('Google Sheets URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const response = await fetch(url);
                const csvText = await response.text();
                
                // CSV íŒŒì‹± (ê°„ë‹¨í•œ ë²„ì „)
                const rows = csvText.split('\n').map(row => row.split(','));
                console.log('ë¶ˆëŸ¬ì˜¨ ë°ì´í„°:', rows);
                
                alert('ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤! (ì½˜ì†” í™•ì¸)');
                
                // ì‹¤ì œ êµ¬í˜„ì‹œ ì—¬ê¸°ì„œ ë°ì´í„°ë¥¼ íŒŒì‹±í•˜ì—¬ 
                // sampleVehicles, sampleBatteries ë“±ì„ ì—…ë°ì´íŠ¸í•˜ê³ 
                // ëª¨ë“  ì°¨íŠ¸ë¥¼ ë‹¤ì‹œ ë Œë”ë§
                
            } catch (error) {
                alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ì´ˆê¸° ë Œë”ë§
        document.addEventListener('DOMContentLoaded', () => {
            renderVehicles();
            renderBatteries();
            renderBatteryChart();
            renderCostChart();
        });
    </script>
</body>
</html>
